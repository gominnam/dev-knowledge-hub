
## AWS를 사용하면서 얻은 5가지 교훈

### 1. 컬럼의 작성 목적과 개요

넷플릭스는 자신이 운영하던 데이터 센터에서 AWS로 이전하면서 많은 것들을 배웠습니다.
이러한 과정에서 몇 가지의 실수들을 통해 얻은 교육들을 공유함으로써 도움이 될 것이라 생각합니다.

### 2. 5가지 교훈들

1. **Dorothy, You’re Not in Kansas Anymore**
    - 만약 자신의 데이터 센터(on-premiss 환경)를 통해 애플리케이션을 디자인하고 배포하는게 익숙하다면, 기존 지식들을 잊어버릴 준비가 돼야 합니다.</br>
      그리고 클라우드 환경과의 차이점을 이해하고 수용할 수 있도록 노력해야 합니다.
      </br></br>
      하드웨어 안정성과 같은 예시가 떠오릅니다.</br>
      세션메모리를 기반으로 한 우리의 데이터센터는 적절한 접근방법 이었습니다. 왜냐하면 하드웨어 장애는 드물기 때문입니다.</br>
      메모리(RAM)에서 상태를 관리하는 것은 합리적이었습니다. 하나의 인스턴스에서 다른 인스턴스로 마이그레이션을 해야하는 경우가 드물기 때문입니다.</br>
      AWS에서 개별 인스턴스 장애가 더 높을 것이라 예상했지만 생각지도 못한 상황들이 있었습니다.
      </br></br>
      예시: Netflix 데이터 센터는 매우 높은 가용성, 속도, 신뢰성있는 네트워크를 갖고 있습니다.</br>
      이 덕분에, 서버 간 네트워크 통신 비용을 크게 고려하지 않고 API를 설계할 수 있었습니다.</br>
      그러나 AWS와 같은 클라우드 환경에서는 네트워크 지연(latency)이 가변적이므로, 서버 간 통신을 더 신중하게 설계해야 했습니다.</br></br>


2. **Co-tenancy is hard.** (공유 인프라의 어려움)
   - 클라우드 환경에서 사용자들이 사용하는 소프트웨어를 설계할 때, 예상 응답 지연 시간을 줄이는게 중요합니다.</br>   
     AWS는 자원을 공유하는 모델로 구축됐습니다. 예를들어: 하드웨어, 네트워크, 스토리지 등</br>
     공유 인프라는 어떤 레벨의 스택에서든 처리량의 변동을 야기합니다.</br>
     특정 하위 작업을 포기할 준비가 되어 있거나, 필요한 경우 AWS 내에서 리소스를 관리하여 공유 인프라를 피해야 합니다.
     </br></br>
     최선의 방법은 어떤 수준에서든 실패를 예상하고 수용할 수 있는 시스템을 구축하는 것입니다. 그러면 다음과 같은 교훈을 얻게 됩니다.</br></br>
     

3. **The best way to avoid failure is to fail constantly.** (실패를 피하는 최고의 방법은 끊임없이 실패하기입니다.)
   - 우리는 때때로 AWS의 Netflix 소프트웨어 아키텍처를 *람보 아키텍처*라고 부릅니다.</br>
     각 시스템은 무슨 일이 있어도, 심지어 혼자서도 성공할 수 있어야 합니다.</br>
     다른 시스템에 의존하는 분산 시스템들을 문제가 생기더라도 결함 내성이 있도록 설계하고 있습니다.
     </br></br> 
     만약 추천시스템이 다운되더라도 사용자들의 응답 퀄리티가 떨어지지만 여전히 응답합니다.</br>
     개별적인 추천 대신에 인기있는 제목들을 보여줍니다.</br>
     검색 시스템이 무척 느려지겠지만 사용자들은 여전히 스트리밍 서비스를 사용할 수 있습니다.</br></br>
   
     엔지니어가 AWS에서 가장 처음으로 만든 시스템 중 하나는 *Chaos Monkey*입니다.</br>
     *Chaos Monkey*는 우리의 아키텍쳐이 있는 서비스중 하나를 무작위로 종료합니다.</br>
     우리가 지속적으로 이러한 실패(Chaos Monkey)에도 성공하도록 테스트하지 않는다면, 예상치 못한 상황에 정상적으로 작동하지 않을 수 있습니다.
     </br></br>


4. **Learn with real scale, not toy models.** (장난감 모델이 아닌 실제 규모로 배우세요.)
   - AWS를 도입하기 전에, 우리는 플랫폼을 연구하고 테스트 시스템을 구축하는 데 시간을 보냈습니다./br>
     실제 트래픽 패턴을 최대한 현실적으로 시뮬레이션하려고 노력했습니다.
     </br></br>
     이는 AWS를 선택하는데 결정적이었지만, 아키텍처를 구상하는데에는 한계가 있었습니다.</br>
     프로적션을 빠르게 구축하고, 단순한 *리피터(repeater)* 를 만들고 모든 고객 요청들을 AWS 시스템으로 복사하였습니다.</br>
     이를 통해 병목 현상이 어디에 있는지 알 수 있었고, 화이트보드에서 명확해 보였던 일부 디자인 선택은 대규모에서는 바보같은 것으로 판명되었습니다.
     </br></br>
     현재도 우리는 AWS 내에서 새로운 기술을 연구하고 있지만, 이제는 실제 데이터를 운영 환경에서 직접 검증하는 방식을 채택하고 있습니다.</br>
     예를 들어, 만약 새로운 NoSQL 옵션을 고려한다면 실제 데이터 저장소를 대상으로 새로운 옵션을 전체 규모로 이식하여 비교하고 있습니다.
     </br></br>


5. Commit yourself. (스스로에게 헌신하세요.)
   - 올해 AWS 마이그레이션에서 팀이 이룬 업적을 되돌아보면 정말 놀랍습니다.</br>
     하지만 항상 이렇게 좋았던 것은 아닙니다. 오늘날의 AWS는 불과 몇 년밖에 되지 않았고, 대규모로 구축하는 선구적인 기업입니다.</br>
     우리가 맡은 작업의 엄청난 규모와 AWS가 운영되는 방식과 Netflix 데이터 센터의 차이에 어려움을 겪으면서 힘든 날들이 있었습니다.
     </br></br>
     장애물에 부딪히면, 그것을 극복할 용기와 확신을 가지세요.</br>
     저희 CEO인 리드 헤이스팅스는 이 마이그레이션에 전적으로 동참했을 뿐만 아니라, 그가 동기를 부여한 사람입니다!</br>
     그와 회사 전체의 기술 리더들의 헌신은 우리가 후퇴를 선택하지 않고 성공을 향해 나아가는 데 도움이 되었습니다.
     </br></br>
     AWS는 엄청난 서비스들이 계속 개선되고 있으며, 오늘날 몇몇 대형 기술 회사들이 성공적으로 운영되고 있습니다.</br>
     여러분도 할 수 있습니다! 우리의 실수와 우리가 얻은 교훈이 여러분이 잘하는 데 도움이 되기를 바랍니다.
     </br></br>


### 3. 용어 설명

- **Dorothy, You’re Not in Kansas Anymore** : 영화 "Wizard of Oz"에서 도로시가 오즈 랜드로 이동하면서 하는 대사. 새로운 환경에 적응해야 한다는 의미.
- **CHAOS MONKEY** : 넷플릭스의 카오스 몽키는 AWS 클라우드 환경에서 임의의 인스턴스를 종료시키는 도구. 
- **Repeater** : 고객 요청을 AWS 시스템으로 복사하는 것을 의미한다. (이는 data repeater를 의미하고 network repeater와 api repeater가 있다.)


## 원본 문헌

[5 Lessons We’ve Learned Using AWS](https://netflixtechblog.com/5-lessons-weve-learned-using-aws-15c9b4d9ee4e)
